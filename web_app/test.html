<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cursor Position</title>
  <style>

    .line {
      padding: 2px;
      white-space: pre-wrap;
    }

    #container {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
    }

    #code {
      max-width: 50%;
      border: 1px solid #ccc;
      margin-top: 20px;
      margin-right: 20px;
      overflow: hidden;
      
    }

    #imageContainer {
      margin-top: 20px;
      margin-right: 20px;
      position: relative;
    }

    .highlight {
      position: absolute;
      background-color: rgba(255, 0, 0, 0.5);
      border: 1px solid blue;
      border-radius: 0px;
      width: 9px; /* Adjust the width of the box */
      height: 12px; /* Adjust the height of the box */
      box-sizing: border-box; /* Include border and padding in the element's total width and height */
      left: 50%; /* Center horizontally */
      top: 50%; /* Center vertically */
      transform: translate(0%, -50%); /*Adjust to center the box precisely */
    }

  </style>
</head>
<body>

<div id="container">
  <div id="imageContainer">
    <img src="test6.jpg" alt="Your Image">
    <div id="highlightPoint" class="highlight"></div>
  </div>

  <div id="code" contenteditable="false">
  </div>
</div>

<script>
  const lines = [
'ininiollo: ipampa, aco itla qualtzin, inj',
 'pan iconiazque: aco itla ipan mo',
 'povatiuj: itla qualli, qujcnopilujz',
 'que. Auh in ieoquicacque, injuh',
 'quj ommjmjctoc, ic vetzca, tlatlapi',
 'tzaoa: inju hquj, ixillan, ijomotlan,',
 'on quaquauhti: injuhquj, mocaca',
 'naoa, paquj, vevetzca: iuhqujn on',
 'tlanavi, iuhqujn ocevetzi, aocac na',
 'oati: ca tlatoliuj, ca tlaquechpili',
 'uj, aiocmo tenaoatili: ic qujmatia, ',
 'aco itla ovi, inpan ie ommuchioaz:',
 'itla ouj, ie con monamjctizque: anoÃ§o  ',
 'ceme aca ie mjqujz: aco ievitz coco',
 'liztli, anoÃ§o  cana inpan, ieo almo',
 'tzaquaz. I njn pan muchioa, yn, ',
 'aco cana tepetzalan; atlauh itic, ',
 'ixtlaoatl itic, quauhnepantla, quauh',
 'ioocatla, quauhitic, quaujtl itic: ',
 'auh intlapuchteca, oztomeca, nene',
 'mjnj: iuhquj inpan omuchiuh, injn',
 'pan ovevetzcac oactli: qujtoaia. ',
 'A co, ie itla, commonamjctizque: ',
 'aco ie ontlaatoctizque: anoÃ§o  ie ',
 'acame, tlaveliloque, in mac ie om',
 'maqujzque, ichtecque, tetlacuj',
 'cujlique, tetlatlacaltique, tetlana',
 'moelique, in mac ieontlatlacazque,',
 'qujn tla cujcujlizque, qujntlacen'
  ];

  const imagePoints = [[[306, 89], [310, 89], [314, 89], [318, 89], [322, 89], [326, 89], [330, 89], [334, 89], [338, 89], [342, 89], [], [353, 89], [357, 89], [361, 89], [365, 89], [369, 89], [373, 89], [377, 89], [], [387, 89], [391, 89], [395, 89], [], [404, 89], [408, 89], [412, 89], [416, 89], [], [425, 89], [429, 89], [433, 89], [437, 89], [441, 89], [445, 89], [449, 89], [453, 89], [457, 89], [], [468, 89], [472, 89], [476, 89]], [[308, 108], [313, 108], [318, 108], [], [329, 108], [334, 108], [339, 108], [344, 108], [349, 108], [354, 108], [359, 108], [364, 108], [369, 108], [374, 108], [379, 108], [], [393, 108], [398, 108], [403, 108], [], [414, 108], [419, 108], [424, 108], [429, 108], [], [440, 108], [445, 108], [450, 108], [455, 108], [], [466, 108], [471, 108]], [[308, 126], [313, 126], [318, 126], [323, 126], [328, 126], [333, 126], [338, 126], [343, 126], [348, 126], [], [358, 126], [363, 126], [368, 126], [373, 126], [], [383, 126], [388, 126], [393, 126], [398, 126], [403, 126], [408, 126], [413, 126], [], [423, 126], [428, 126], [433, 126], [438, 126], [443, 126], [448, 126], [453, 126], [458, 126], [463, 126], [468, 126], [473, 126], [478, 126]], [[309, 142], [315, 142], [321, 142], [326, 142], [], [335, 142], [340, 142], [344, 142], [], [357, 142], [362, 142], [], [373, 142], [379, 142], [385, 142], [391, 142], [397, 142], [403, 142], [409, 142], [415, 142], [421, 142], [427, 142], [433, 142], [439, 142], [445, 142], [], [449, 142], [454, 142], [459, 142], [464, 142], [469, 142]], [[307, 162], [312, 162], [317, 162], [], [325, 162], [330, 162], [335, 162], [340, 162], [345, 162], [350, 162], [355, 162], [360, 162], [365, 162], [370, 162], [375, 162], [], [383, 162], [388, 162], [], [396, 162], [401, 162], [406, 162], [411, 162], [416, 162], [421, 162], [426, 162], [], [434, 162], [439, 162], [444, 162], [449, 162], [454, 162], [459, 162], [464, 162], [469, 162]], [[307, 179], [312, 179], [317, 179], [322, 179], [327, 179], [331, 179], [], [339, 179], [344, 179], [349, 179], [354, 179], [], [362, 179], [367, 179], [372, 179], [377, 179], [381, 179], [], [389, 179], [394, 179], [399, 179], [404, 179], [409, 179], [414, 179], [419, 179], [423, 179], [], [431, 179], [436, 179], [441, 179], [446, 179], [451, 179], [456, 179], [461, 179], [466, 179], [471, 179], [475, 179]], [[308, 198], [313, 198], [], [324, 198], [330, 198], [336, 198], [342, 198], [348, 198], [354, 198], [360, 198], [366, 198], [372, 198], [378, 198], [381, 198], [], [390, 198], [396, 198], [402, 198], [408, 198], [414, 198], [420, 198], [426, 198], [432, 198], [436, 198], [], [445, 198], [451, 198], [457, 198], [463, 198], [469, 198], [473, 198]], [[306, 216], [311, 216], [316, 216], [321, 216], [326, 216], [], [337, 216], [342, 216], [347, 216], [352, 216], [357, 216], [362, 216], [], [373, 216], [378, 216], [383, 216], [388, 216], [393, 216], [398, 216], [403, 216], [408, 216], [413, 216], [], [424, 216], [429, 216], [434, 216], [439, 216], [444, 216], [449, 216], [454, 216], [], [465, 216], [470, 216]], [[306, 232], [311, 232], [316, 232], [321, 232], [326, 232], [331, 232], [336, 232], [341, 232], [], [349, 232], [354, 232], [359, 232], [364, 232], [369, 232], [374, 232], [379, 232], [], [387, 232], [392, 232], [397, 232], [402, 232], [407, 232], [412, 232], [417, 232], [422, 232], [427, 232], [], [435, 232], [440, 232], [445, 232], [450, 232], [455, 232], [], [463, 232], [468, 232]], [[305, 251], [310, 251], [315, 251], [320, 251], [325, 251], [], [335, 251], [340, 251], [], [350, 251], [355, 251], [360, 251], [365, 251], [370, 251], [375, 251], [380, 251], [385, 251], [390, 251], [395, 251], [], [405, 251], [410, 251], [], [420, 251], [425, 251], [430, 251], [435, 251], [440, 251], [445, 251], [450, 251], [455, 251], [460, 251], [465, 251], [470, 251], [475, 251]], [[306, 271], [311, 271], [316, 271], [], [324, 271], [329, 271], [334, 271], [339, 271], [344, 271], [349, 271], [], [357, 271], [362, 271], [367, 271], [372, 271], [377, 271], [382, 271], [387, 271], [392, 271], [397, 271], [402, 271], [407, 271], [], [415, 271], [420, 271], [], [428, 271], [433, 271], [438, 271], [443, 271], [448, 271], [453, 271], [458, 271], [463, 271], [468, 271]], [[306, 289], [311, 289], [316, 289], [], [326, 289], [331, 289], [336, 289], [341, 289], [], [351, 289], [356, 289], [361, 289], [366, 289], [], [376, 289], [381, 289], [386, 289], [391, 289], [396, 289], [], [407, 289], [412, 289], [], [422, 289], [427, 289], [432, 289], [437, 289], [442, 289], [447, 289], [452, 289], [457, 289], [462, 289], [467, 289], [472, 289]], [[306, 307], [310, 307], [314, 307], [318, 307], [], [327, 307], [331, 307], [335, 307], [339, 307], [], [348, 307], [352, 307], [], [360, 307], [364, 307], [368, 307], [], [377, 307], [381, 307], [385, 307], [389, 307], [393, 307], [397, 307], [401, 307], [405, 307], [409, 307], [413, 307], [417, 307], [421, 307], [425, 307], [429, 307], [], [443, 307], [447, 307], [451, 307], [455, 307], [459, 307], [463, 307]], [[307, 326], [312, 326], [317, 326], [322, 326], [], [330, 326], [335, 326], [340, 326], [], [348, 326], [353, 326], [], [361, 326], [366, 326], [371, 326], [376, 326], [381, 326], [386, 326], [391, 326], [], [399, 326], [404, 326], [409, 326], [], [417, 326], [422, 326], [427, 326], [432, 326], [437, 326], [442, 326], [], [450, 326], [455, 326], [460, 326], [465, 326]], [[306, 345], [311, 345], [316, 345], [321, 345], [326, 345], [331, 345], [335, 345], [], [343, 345], [348, 345], [353, 345], [358, 345], [363, 345], [367, 345], [], [375, 345], [380, 345], [385, 345], [390, 345], [], [398, 345], [403, 345], [408, 345], [413, 345], [418, 345], [422, 345], [], [430, 345], [435, 345], [440, 345], [], [448, 345], [453, 345], [458, 345], [463, 345]], [[307, 364], [312, 364], [317, 364], [322, 364], [327, 364], [332, 364], [337, 364], [342, 364], [], [354, 364], [], [364, 364], [369, 364], [374, 364], [], [385, 364], [390, 364], [395, 364], [], [406, 364], [411, 364], [416, 364], [421, 364], [426, 364], [431, 364], [436, 364], [441, 364], [], [453, 364], [458, 364], [463, 364]], [[307, 383], [312, 383], [317, 383], [], [327, 383], [332, 383], [337, 383], [342, 383], [], [352, 383], [357, 383], [362, 383], [367, 383], [372, 383], [377, 383], [382, 383], [387, 383], [392, 383], [397, 383], [402, 383], [], [412, 383], [417, 383], [422, 383], [427, 383], [432, 383], [437, 383], [], [447, 383], [452, 383], [457, 383], [462, 383], [467, 383]], [[307, 400], [312, 400], [317, 400], [322, 400], [327, 400], [332, 400], [337, 400], [342, 400], [347, 400], [], [355, 400], [360, 400], [365, 400], [370, 400], [375, 400], [], [383, 400], [388, 400], [393, 400], [398, 400], [403, 400], [408, 400], [413, 400], [418, 400], [423, 400], [428, 400], [433, 400], [438, 400], [443, 400], [447, 400], [], [455, 400], [460, 400], [465, 400], [470, 400], [475, 400]], [[307, 418], [312, 418], [317, 418], [322, 418], [327, 418], [332, 418], [337, 418], [342, 418], [346, 418], [], [354, 418], [359, 418], [364, 418], [369, 418], [374, 418], [379, 418], [384, 418], [389, 418], [394, 418], [398, 418], [], [406, 418], [411, 418], [416, 418], [421, 418], [426, 418], [431, 418], [435, 418], [], [443, 418], [448, 418], [453, 418], [458, 418], [463, 418]], [[306, 436], [311, 436], [316, 436], [], [326, 436], [331, 436], [336, 436], [341, 436], [346, 436], [351, 436], [356, 436], [361, 436], [366, 436], [371, 436], [376, 436], [381, 436], [386, 436], [391, 436], [], [405, 436], [410, 436], [415, 436], [420, 436], [425, 436], [430, 436], [435, 436], [440, 436], [445, 436], [], [457, 436], [462, 436], [467, 436], [472, 436]], [[306, 454], [311, 454], [316, 454], [321, 454], [326, 454], [], [337, 454], [342, 454], [347, 454], [352, 454], [357, 454], [362, 454], [], [374, 454], [379, 454], [384, 454], [389, 454], [394, 454], [], [405, 454], [410, 454], [415, 454], [420, 454], [425, 454], [430, 454], [435, 454], [440, 454], [445, 454], [], [458, 454], [463, 454], [468, 454], [473, 454]], [[305, 473], [310, 473], [315, 473], [], [326, 473], [331, 473], [336, 473], [341, 473], [346, 473], [351, 473], [356, 473], [361, 473], [366, 473], [371, 473], [], [384, 473], [389, 473], [394, 473], [399, 473], [404, 473], [409, 473], [414, 473], [], [426, 473], [431, 473], [436, 473], [441, 473], [446, 473], [451, 473], [456, 473], [461, 473], [466, 473]], [[305, 491], [], [315, 491], [320, 491], [325, 491], [], [335, 491], [340, 491], [], [350, 491], [355, 491], [360, 491], [365, 491], [370, 491], [], [381, 491], [386, 491], [391, 491], [396, 491], [401, 491], [406, 491], [411, 491], [416, 491], [421, 491], [426, 491], [431, 491], [436, 491], [441, 491], [446, 491], [451, 491], [456, 491], [461, 491]], [[306, 510], [311, 510], [316, 510], [], [324, 510], [329, 510], [], [337, 510], [342, 510], [347, 510], [352, 510], [357, 510], [362, 510], [367, 510], [372, 510], [377, 510], [382, 510], [387, 510], [392, 510], [397, 510], [402, 510], [407, 510], [412, 510], [], [420, 510], [425, 510], [430, 510], [435, 510], [440, 510], [445, 510], [], [453, 510], [458, 510]], [[306, 529], [311, 529], [316, 529], [321, 529], [326, 529], [331, 529], [], [342, 529], [347, 529], [352, 529], [357, 529], [362, 529], [367, 529], [372, 529], [377, 529], [382, 529], [387, 529], [392, 529], [397, 529], [402, 529], [], [414, 529], [419, 529], [], [429, 529], [434, 529], [439, 529], [], [449, 529], [454, 529], [], [464, 529], [469, 529]], [[306, 545], [312, 545], [318, 545], [324, 545], [330, 545], [336, 545], [342, 545], [348, 545], [354, 545], [358, 545], [], [367, 545], [373, 545], [379, 545], [385, 545], [391, 545], [397, 545], [403, 545], [409, 545], [415, 545], [419, 545], [], [428, 545], [434, 545], [440, 545], [446, 545], [452, 545], [458, 545], [464, 545], [468, 545]], [[307, 562], [312, 562], [317, 562], [322, 562], [327, 562], [332, 562], [337, 562], [342, 562], [347, 562], [], [356, 562], [361, 562], [366, 562], [371, 562], [376, 562], [381, 562], [386, 562], [391, 562], [396, 562], [401, 562], [406, 562], [411, 562], [416, 562], [421, 562], [426, 562], [431, 562], [436, 562], [], [446, 562], [451, 562], [456, 562], [461, 562], [466, 562], [471, 562], [476, 562]], [[306, 580], [311, 580], [316, 580], [321, 580], [326, 580], [331, 580], [336, 580], [341, 580], [346, 580], [], [357, 580], [362, 580], [], [372, 580], [377, 580], [382, 580], [], [392, 580], [397, 580], [402, 580], [407, 580], [412, 580], [417, 580], [422, 580], [427, 580], [432, 580], [437, 580], [442, 580], [447, 580], [452, 580], [457, 580], [462, 580], [467, 580], [472, 580]], [[307, 598], [312, 598], [317, 598], [322, 598], [], [332, 598], [337, 598], [342, 598], [], [352, 598], [357, 598], [362, 598], [367, 598], [372, 598], [377, 598], [382, 598], [387, 598], [392, 598], [397, 598], [402, 598], [407, 598], [412, 598], [], [424, 598], [429, 598], [434, 598], [439, 598], [444, 598], [449, 598], [454, 598], [459, 598], [464, 598], [469, 598]]]

  const codeContainer = document.getElementById('code');
  const imageContainer = document.getElementById('imageContainer');
  const highlightPoint = document.getElementById('highlightPoint');

  lines.forEach((line, index) => {
    const div = document.createElement('div');
    div.textContent = line;
    div.className = 'line';
    div.id = `line${index + 1}`;
    codeContainer.appendChild(div);
  });

  document.addEventListener('click', updateCursorPosition);

  function updateCursorPosition(event) {
    const { target } = event;

    // Check if the clicked element is a line in the code
    if (target.classList.contains('line')) {
      const line = getLineNumber(target);
      const character = Math.floor(event.offsetX / getAverageCharWidth(target));

      // Highlight the corresponding point on the image
      highlightImagePoint(line, character);
    }
  }

  function getLineNumber(target) {
    const id = target.id;
    const line = parseInt(id.replace('line', ''), 10);
    return line;
  }

  function getAverageCharWidth(target) {
    const text = target.textContent.replace(/\s/g, 'W'); // Replace spaces with a character for accurate width
    const testSpan = document.createElement('span');
    testSpan.textContent = text;
    target.appendChild(testSpan);
    const width = testSpan.offsetWidth / text.length;
    target.removeChild(testSpan);
    return width;
  }

  function highlightImagePoint(line, character) {
    // Assuming line and character are 1-based indices
    const pointsForLine = imagePoints[line - 1];
    console.log('Line ', line);
    console.log('Character ', character);
    if (pointsForLine && character <= pointsForLine.length) {
      console.log('IN IF');
      if(pointsForLine[character - 1].length>0){
        const [x, y] = pointsForLine[character - 1];
        highlightPoint.style.left = `${x}px`;
        highlightPoint.style.top = `${y}px`;
        highlightPoint.style.display = 'block';
      }

     
    } else {
      // Hide the highlight if no valid point is found
      highlightPoint.style.display = 'none';
    }
  }
</script>

</body>
</html>
